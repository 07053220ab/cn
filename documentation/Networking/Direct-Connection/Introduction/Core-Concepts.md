## **专业术语**

| **术语** | **定义**                                                     |
| -------- | ------------------------------------------------------------ |
| BGW      | Border Gateway，边界网关，外部访问VPC内业务的流量终结点      |
| DLR      | 专线路由器，专线连接服务需要用到的三层路由设备，用于对接物理链路 |
| VNET     | Virtual Network，虚拟网络                                    |
| Circuit  | 线路，客户与京东云间连接的物理链路的逻辑描述                 |
| IXP      | Internet Exchange Point，互联网交换节点                      |
| BGP      | Border Gateway Protocal，边界网关协议                        |
| Partner  | 京东云专线连接服务的合作伙伴，为京东云客户提供专线连接服务   |
| S-tag    | 一个vlan tag，用于配置QinQ时在物理端口上唯一标识一个客户的数据流，QinQ的外层tag |
| C-tag    | 一个vlan tag，用于配置QinQ时在物理端口上唯一标识客户的一个业务通道的数据流，QinQ的内层tag |

 ## **路由相关说明**
边界网关作为京东云多个隔离网络（VPC）之间、或者从京东云云端与用户IDC互联的路由网关，提供了静态与BGP动态路由能力，同时为了简化用户业务部署而支持了VPC与网关之间路由的双向传播能力，以便完整支持从VPC到IDC端到端的路由自动更新。

### **路由传播**

路由传播是指不通过标准BGP协议等动态路由方式，通过内部工作机制将不同网关实体（如VPC路由表所在的路由网关、边界网关）的路由表项信息进行同步、自动更新到达或者经由彼此转发业务的路由信息。

VPC路由表和边界网关路由表之间可通过VPC接口实现双向路由动态传播：

  边界网关->VPC方向的路由传播：当VPC路由表配置路由传播时，选择路由传播的源边界网关与填写路由传播范围，系统将自动把该边界网关有效路由表中、路由前缀在传播范围内的特定路由规则自动添加VPC路由表内，并且下一跳指向该VPC与此边界网关互联的VPC接口；
  
  VPC->边界网关方向的路由传播：当基于BGW创建VPC接口时，如果传播VPC网段选择“VPC全部网段”或者“指定子网网段”时，即为路由自动传播方式。边界网关路由表会依据配置的子网范围，自动添加或者删除到达相关子网的路由表项，路由前缀为子网网段、下一跳为连接指定VPC和边界网关的VPC接口。


### **路由优先级**

#### **VPC路由表**

VPC路由表支持两种路由方式：动态（传播）路由与静态路由。

VPC路由表路由规则匹配规则：
Local路由优先；
最长前缀匹配优先；
同样长度前缀prefix、路由类型相同(如同为传播路由、或同为静态路由)，则为等价路由（？？？）；
同样长度前缀prefix，路由类型不同，则静态路由优于动态传播路由；

静态路由优先级缺省为100，传播路由优先级缺省为150，优先级范围为1~256。（？？）

#### **边界网关路由表**

边界网关路由表支持三种路由方式：动态路由、传播路由与静态路由。

边界网关路由优选顺序与匹配细则：
最长前缀匹配优先；
同样长度前缀prefix、路由类型相同(如同为静态路由、或同为动态路由)，则为等价路由（？？？）；
同样长度前缀prefix，路由类型不同，则静态路由优于动态传播路由；

静态路由优先级100，同前缀prefix均视为ECMP。后续开放静态路由自定义优先级，用户有更灵活的控制能力，如把VPN静态路由配置到比BGP路由优先级低；

动态路由内部排序：
VPC传播路由优先级110，相同prefix仅一条、先加入者生效，先加入路由表的vpc传播路由删除后、后续的vpc传播路由再生效；

其次是EBGP动态路由优先级120，如果同为EBGP路由，则按照如下顺序从上到下优选：
AS_PATH最短的路由优选；
如果AS_PATH相同，最小MED路由优选；
如果AS_PATH和MED都相同，则视为等价路由；

IBGP动态路由优先级200；
