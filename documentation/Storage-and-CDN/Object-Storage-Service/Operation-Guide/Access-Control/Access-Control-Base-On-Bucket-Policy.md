# 基于Bucket Policy的权限控制

## Bucket Policy 

Bucket Policy是基于资源的授权策略。访问策略使用基于 JSON 的访问策略语言。您可以通过访问策略语言授权指定委托人（principal）对指定的 OSS 资源执行指定的操作。

### Bucket Policy常见的应用场景如下：

-   向其他账号直接授权访问。

    您可以授予其他主账号访问您的OSS资源的权限。

-   向其他账号的RAM用户授权访问。

    您可以授予其他账号的RAM用户访问您的OSS资源的权限。

-   向匿名用户授予带特定条件限制的访问权限。

     某些场景下，您需要向匿名用户授予带IP限制的访问策略。例如，您对外提供服务的网站中静态文件存储在OSS，为避免被其他人盗链，产生不必要的费用。您可以通过Bucket policy设置带Referer限制的策略，来指定允许访问的名单。或者您企业内部的机密文档，只希望在企业内部访问，您可以基于Bucket Policy设置带IP限制的访问策略。以上场景都是存在访问人员数量大，如果针对每个人配置IAM Policy，工作量非常大。此时，利用Bucket Policy您可以高效方便地进行授权。
     
### Bucket Policy（存储空间策略）基本元素

#### 存储空间策略语言包含以下基本意义的元素：

**说明：** 目前Bucket Policy与 IAM Policy 元素与元素用略有不同，请根据您的使用情况做好区分，不要混淆二者。

* 委托人（principal）：描述策略授权的实体。例如用户，可能是其他合作商（主账号）、子账号、匿名用户等。该元素对于存储空间访问策略有效，对用户访问策略则不应添加。
* 语句（statement）：描述一条或多条权限的详细信息。该元素包括效力、操作、资源、条件等多个其他元素的权限或权限集合。一条策略有且仅有一个语句元素。
    - 效力（Effect）：描述声明产生的结果是“允许”还是“显式拒绝”，包括 allow 和 deny 两种情况。该元素是必填项。
    - 操作（Action）：描述被允许或拒绝的操作。操作可以是 API或者功能集（一组特定的 API）。该元素是必填项，详见下文【元素用法-Action】。
    - 资源（Resource）：描述指代的是 OSS 上面的某个具体的资源或者某些资源。资源是用六段式描述。该元素是必填项，有关如何指定资源的信息，详见下文【元素用法-Resource】。
    - 条件（Condition）：描述策略生效的约束条件。条件包括操作符、操作键和操作值组成。条件值可包括Referer、IP 地址信息。该元素是非必填项。
    
## 元素用法 

### 指定委托人

委托人 principal 元素用于指定被允许或拒绝访问资源的用户、账户、服务或其他实体。元素 principal 仅在存储空间中起作用；用户策略中不必指定，因为用户策略直接附加到特定用户。下面是在OSS Bucket Policy 中指定 principal 的示例。
   
**说明**
- account-ID：为主账号的账户ID，获取方式：主账号登录京东云控制台后，点击账号管理，产看基本资料页即可获取。
- 用户类型关键字：子用户（user）与主用户（root）
- principal不支持通配符

1.要授予京东云其他主账号权限

    在指定主账号时，您可以使用账户 AWS: arn:aws:iam::account-ID:root 或 AWS: 前缀后加账户 ID 构成的简略格式。
    示例
    例如，给定账户 ID 为 123456789012 的情况下，您可以使用以下任一方法来在 Principal 元素中指定账户：
    ```
    //单个账号

    "Principal":{"AWS":"arn:aws:iam::123456789012:root"}
    // 或者
    "Principal": { "AWS": "123456789012"}

    //多个账号

    "Principal": {
    "AWS": [
    "arn:aws:iam::123456789012:root",
    "111111111111"
    ]
    }  
    ```
2.要授予京东云IAM 子用户权限

  指定IAM 子用户:"AWS": "arn:aws:iam::account-ID:user/user-name"
  user-name 为您想要授权的子用户用户名
    
       ```
            //单个IAM 子用户
            "Principal": { "AWS": "arn:aws:iam::123456789012:user/user-name" }  
            //多个IAM 子用户
            "Principal": {
            "AWS": [
                "arn:aws:iam::123456789012/user-name-1",
                "arn:aws:iam::111111111111:user/UserName2"
             ]
            }

        ``` 
    
3.要授予每个人权限，也称为匿名访问
 
  例如，如果您将存储空间配置为网站，您需要该存储空间中的所有对象都可公开访问，请将Principal的值设置为 "*" 
  示例：
  
      ```
      "Principal":"*"
      //或者
      "Principal":{"AWS":"*"}
      ```




